<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>æ—…è¡Œé¢„ç®—ç®¡ç† - iOSé£æ ¼</title>
  <!-- å¼•å…¥Tailwind CSS -->
  <script src="https://cdn.tailwindcss.com"></script>
  <!-- å¼•å…¥Font Awesomeå›¾æ ‡ -->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">
  <!-- è‡ªå®šä¹‰Tailwindä¸»é¢˜ï¼šé€‚é…iOSé£æ ¼ -->
  <script>
    tailwind.config = {
      theme: {
        extend: {
          colors: {
            primary: '#007AFF', // iOSç»å…¸è“
            secondary: '#F5F5F7', // iOSèƒŒæ™¯ç°
            light: '#F2F2F7', // å¡ç‰‡æµ…ç°
            dark: '#1D1D1F', // æ–‡å­—æ·±ç°
            gray: {
              100: '#F8F8FA',
              200: '#E8E8ED',
              300: '#D1D1D6',
              400: '#999999',
              500: '#666666',
            }
          },
          borderRadius: {
            'ios': '12px', // iOSå¡ç‰‡åœ†è§’
            'ios-sm': '8px', // æŒ‰é’®/è¾“å…¥æ¡†åœ†è§’
          },
          boxShadow: {
            'ios': '0 2px 8px rgba(0, 0, 0, 0.08)', // iOSè½»é˜´å½±
            'ios-hover': '0 4px 12px rgba(0, 122, 255, 0.12)', // å¡ç‰‡æ‚¬æµ®é˜´å½±
          },
          fontFamily: {
            inter: ['Inter', 'system-ui', 'sans-serif'], // é€‚é…å¤šè®¾å¤‡å­—ä½“
          }
        },
      }
    }
  </script>
  <style type="text/tailwindcss">
    @layer utilities {
      .content-auto {
        content-visibility: auto;
      }
      .scrollbar-hide {
        -ms-overflow-style: none;
        scrollbar-width: none;
      }
      .scrollbar-hide::-webkit-scrollbar {
        display: none;
      }
      .route-line {
        @apply w-0.5 bg-primary/30 h-full mx-auto;
      }
      .route-node-active {
        @apply ring-2 ring-primary ring-offset-2 ring-offset-white;
      }
    }
    /* å…¨å±€æ ·å¼ */
    body {
      @apply bg-secondary font-inter text-dark;
    }
    .card-ios {
      @apply bg-white rounded-ios shadow-ios hover:shadow-ios-hover transition-shadow duration-300 mb-4;
    }
    .btn-ios {
      @apply bg-primary text-white rounded-ios-sm py-2 px-4 font-medium hover:bg-primary/90 active:bg-primary/80 transition-all duration-200;
    }
    .btn-ios-outline {
      @apply border border-primary text-primary rounded-ios-sm py-2 px-4 font-medium hover:bg-primary/5 transition-all duration-200;
    }
    .input-ios {
      @apply w-full border border-gray-200 rounded-ios-sm py-2 px-3 focus:border-primary focus:outline-none focus:ring-1 focus:ring-primary/50 transition-all duration-200;
    }
    .tab-active {
      @apply border-b-2 border-primary text-primary;
    }
  </style>
</head>
<body class="min-h-screen flex flex-col">
  <!-- é¡¶éƒ¨å¯¼èˆªæ ï¼šå›ºå®š+è‡ªé€‚åº” -->
  <header class="sticky top-0 z-50 bg-white shadow-sm">
    <div class="container mx-auto px-4 py-3 flex items-center justify-between">
      <!-- å·¦ä¾§Logo -->
      <div class="flex items-center gap-2">
        <i class="fa-solid fa-suitcase-rolling text-primary text-xl"></i>
        <h1 class="text-lg font-bold hidden sm:block">æ—…è¡Œé¢„ç®—ç®¡ç†</h1>
        <h1 class="text-lg font-bold sm:hidden">æ—…è¡Œé¢„ç®—</h1>
      </div>

      <!-- ä¸­é—´æ ‡ç­¾ï¼šç”µè„‘/å¹³æ¿æ˜¾ç¤ºï¼Œæ‰‹æœºéšè— -->
      <nav class="hidden md:flex items-center gap-6">
        <a href="#train" class="tab-link py-1 text-sm tab-active"><i class="fa-solid fa-train mr-1"></i>ç«è½¦</a>
        <a href="#plane" class="tab-link py-1 text-sm"><i class="fa-solid fa-plane mr-1"></i>é£æœº</a>
        <a href="#hotel" class="tab-link py-1 text-sm"><i class="fa-solid fa-hotel mr-1"></i>é…’åº—</a>
        <a href="#restaurant" class="tab-link py-1 text-sm"><i class="fa-solid fa-utensils mr-1"></i>é¤å…</a>
        <a href="#scenic" class="tab-link py-1 text-sm"><i class="fa-solid fa-mountain-sun mr-1"></i>æ™¯ç‚¹</a>
        <a href="#route" class="tab-link py-1 text-sm"><i class="fa-solid fa-map-location-dot mr-1"></i>è·¯çº¿</a>
      </nav>

      <!-- å³ä¾§åŠŸèƒ½æŒ‰é’® -->
      <div class="flex items-center gap-3">
        <button id="compareBtn" class="btn-ios-outline text-sm hidden sm:flex items-center">
          <i class="fa-solid fa-balance-scale mr-1"></i>å¯¹æ¯”
        </button>
        <button id="addCustomBtn" class="btn-ios-outline text-sm flex items-center">
          <i class="fa-solid fa-plus mr-1"></i>è‡ªå®šä¹‰
        </button>
        <!-- æ‰‹æœºç«¯æ±‰å ¡èœå• -->
        <button id="hamburgerBtn" class="sm:hidden text-dark text-xl">
          <i class="fa-solid fa-bars"></i>
        </button>
      </div>
    </div>

    <!-- æ±‰å ¡èœå•å¼¹çª—ï¼šæ‰‹æœºç«¯ -->
    <div id="hamburgerMenu" class="hidden absolute top-full left-0 w-full bg-white shadow-ios py-3 px-4 flex flex-col gap-3">
      <a href="#train" class="hamburger-tab py-2 px-3 rounded-ios-sm hover:bg-light flex items-center gap-2"><i class="fa-solid fa-train text-primary"></i>ç«è½¦</a>
      <a href="#plane" class="hamburger-tab py-2 px-3 rounded-ios-sm hover:bg-light flex items-center gap-2"><i class="fa-solid fa-plane text-primary"></i>é£æœº</a>
      <a href="#hotel" class="hamburger-tab py-2 px-3 rounded-ios-sm hover:bg-light flex items-center gap-2"><i class="fa-solid fa-hotel text-primary"></i>é…’åº—</a>
      <a href="#restaurant" class="hamburger-tab py-2 px-3 rounded-ios-sm hover:bg-light flex items-center gap-2"><i class="fa-solid fa-utensils text-primary"></i>é¤å…</a>
      <a href="#scenic" class="hamburger-tab py-2 px-3 rounded-ios-sm hover:bg-light flex items-center gap-2"><i class="fa-solid fa-mountain-sun text-primary"></i>æ™¯ç‚¹</a>
      <a href="#route" class="hamburger-tab py-2 px-3 rounded-ios-sm hover:bg-light flex items-center gap-2"><i class="fa-solid fa-map-location-dot text-primary"></i>è·¯çº¿</a>
      <button class="hamburger-tab py-2 px-3 rounded-ios-sm hover:bg-light flex items-center gap-2 text-primary border border-primary/30">
        <i class="fa-solid fa-balance-scale"></i>è½¦æ¬¡/èˆªç­å¯¹æ¯”
      </button>
    </div>
  </header>

  <!-- ä¸»å†…å®¹åŒºï¼šè‡ªé€‚åº”+å¡ç‰‡å¼ -->
  <main class="flex-1 container mx-auto px-4 py-6">
    <!-- è½¦æ¬¡/èˆªç­å¯¹æ¯”å¼¹çª—ï¼šé•¿æ˜¥â†’è“Ÿå·åŒºä¸­è½¬ä¸“å± -->
    <div id="compareModal" class="fixed inset-0 z-50 bg-black/50 flex items-center justify-center hidden">
      <div class="bg-white rounded-ios w-full max-w-3xl max-h-[80vh] overflow-y-auto scrollbar-hide p-6">
        <div class="flex justify-between items-center mb-4">
          <h2 class="text-lg font-bold flex items-center gap-2">
            <i class="fa-solid fa-balance-scale text-primary"></i>è½¦æ¬¡/èˆªç­å¯¹æ¯”ï¼ˆé•¿æ˜¥â†’è“Ÿå·åŒºï¼‰
          </h2>
          <button id="closeCompareModal" class="text-gray-400 hover:text-gray-600">
            <i class="fa-solid fa-xmark text-xl"></i>
          </button>
        </div>
        <!-- å¯¹æ¯”ç±»å‹é€‰æ‹© -->
        <div class="flex gap-4 mb-6">
          <button class="compare-type-btn btn-ios text-sm" data-type="train">ç«è½¦è½¦æ¬¡</button>
          <button class="compare-type-btn btn-ios-outline text-sm" data-type="plane">é£æœºèˆªç­</button>
        </div>
        <!-- å¯¹æ¯”ç»“æœè¡¨æ ¼ï¼šç«è½¦ -->
        <div id="trainCompareTable" class="w-full">
          <table class="w-full border-collapse">
            <thead>
              <tr class="bg-light rounded-ios-sm">
                <th class="py-3 px-2 text-left text-sm font-medium">ä¸­è½¬åœ°</th>
                <th class="py-3 px-2 text-left text-sm font-medium">è½¦æ¬¡ï¼ˆé•¿æ˜¥â†’ä¸­è½¬ï¼‰</th>
                <th class="py-3 px-2 text-left text-sm font-medium">è€—æ—¶/ä»·æ ¼</th>
                <th class="py-3 px-2 text-left text-sm font-medium">è½¦æ¬¡ï¼ˆä¸­è½¬â†’å¤©æ´¥ï¼‰</th>
                <th class="py-3 px-2 text-left text-sm font-medium">è€—æ—¶/ä»·æ ¼</th>
                <th class="py-3 px-2 text-left text-sm font-medium">æ€»è€—æ—¶/æ€»ä»·æ ¼</th>
              </tr>
            </thead>
            <tbody id="trainCompareBody" class="divide-y divide-gray-100">
              <!-- JSåŠ¨æ€ç”Ÿæˆå¯¹æ¯”æ•°æ® -->
            </tbody>
          </table>
          <p id="trainCompareEmpty" class="text-center py-8 text-gray-400">æš‚æ— ä¸­è½¬è½¦æ¬¡æ•°æ®ï¼Œå…ˆæ·»åŠ é•¿æ˜¥â†’ä¸­è½¬åœ°ã€ä¸­è½¬åœ°â†’å¤©æ´¥çš„è½¦æ¬¡å§ï½</p>
        </div>
        <!-- å¯¹æ¯”ç»“æœè¡¨æ ¼ï¼šé£æœº -->
        <div id="planeCompareTable" class="w-full hidden">
          <table class="w-full border-collapse">
            <thead>
              <tr class="bg-light rounded-ios-sm">
                <th class="py-3 px-2 text-left text-sm font-medium">ä¸­è½¬åœ°</th>
                <th class="py-3 px-2 text-left text-sm font-medium">èˆªç­ï¼ˆé•¿æ˜¥â†’ä¸­è½¬ï¼‰</th>
                <th class="py-3 px-2 text-left text-sm font-medium">è€—æ—¶/ä»·æ ¼</th>
                <th class="py-3 px-2 text-left text-sm font-medium">èˆªç­ï¼ˆä¸­è½¬â†’å¤©æ´¥ï¼‰</th>
                <th class="py-3 px-2 text-left text-sm font-medium">è€—æ—¶/ä»·æ ¼</th>
                <th class="py-3 px-2 text-left text-sm font-medium">æ€»è€—æ—¶/æ€»ä»·æ ¼</th>
              </tr>
            </thead>
            <tbody id="planeCompareBody" class="divide-y divide-gray-100">
              <!-- JSåŠ¨æ€ç”Ÿæˆå¯¹æ¯”æ•°æ® -->
            </tbody>
          </table>
          <p id="planeCompareEmpty" class="text-center py-8 text-gray-400">æš‚æ— ä¸­è½¬èˆªç­æ•°æ®ï¼Œå…ˆæ·»åŠ é•¿æ˜¥â†’ä¸­è½¬åœ°ã€ä¸­è½¬åœ°â†’å¤©æ´¥çš„èˆªç­å§ï½</p>
        </div>
      </div>
    </div>

    <!-- è‡ªå®šä¹‰åˆ†ç±»æ·»åŠ å¼¹çª— -->
    <div id="customModal" class="fixed inset-0 z-50 bg-black/50 flex items-center justify-center hidden">
      <div class="bg-white rounded-ios w-full max-w-md p-6">
        <div class="flex justify-between items-center mb-4">
          <h2 class="text-lg font-bold flex items-center gap-2">
            <i class="fa-solid fa-plus-circle text-primary"></i>æ·»åŠ è‡ªå®šä¹‰åˆ†ç±»
          </h2>
          <button id="closeCustomModal" class="text-gray-400 hover:text-gray-600">
            <i class="fa-solid fa-xmark text-xl"></i>
          </button>
        </div>
        <form id="customForm" class="flex flex-col gap-4">
          <div>
            <label class="block text-sm font-medium text-gray-500 mb-1">åˆ†ç±»åç§°</label>
            <input type="text" name="customName" class="input-ios" placeholder="å¦‚ï¼šç§Ÿè½¦ã€ç‰¹äº§ã€é—¨ç¥¨" required>
          </div>
          <div>
            <label class="block text-sm font-medium text-gray-500 mb-1">é€‰æ‹©å›¾æ ‡</label>
            <select name="customIcon" class="input-ios" required>
              <option value="car">ğŸš— ç§Ÿè½¦</option>
              <option value="gift">ğŸ ç‰¹äº§</option>
              <option value="ticket">ğŸ« é—¨ç¥¨</option>
              <option value="camera">ğŸ“· æ‹ç…§</option>
              <option value="coffee">â˜• é¥®å“</option>
            </select>
          </div>
          <div>
            <label class="block text-sm font-medium text-gray-500 mb-1">é¢„ç®—é‡‘é¢ï¼ˆÂ¥ï¼‰</label>
            <input type="number" name="customPrice" class="input-ios" placeholder="è¯·è¾“å…¥é‡‘é¢" min="0" step="0.01" required>
          </div>
          <div>
            <label class="block text-sm font-medium text-gray-500 mb-1">å¤‡æ³¨</label>
            <textarea name="customDesc" class="input-ios" rows="2" placeholder="è¯·è¾“å…¥å¤‡æ³¨ï¼ˆé€‰å¡«ï¼‰"></textarea>
          </div>
          <button type="submit" class="btn-ios w-full">æ·»åŠ åˆ†ç±»</button>
        </form>
      </div>
    </div>

    <!-- ç«è½¦æ¨¡å— -->
    <section id="train" class="tab-content">
      <div class="flex justify-between items-center mb-4">
        <h2 class="text-xl font-bold flex items-center gap-2">
          <i class="fa-solid fa-train text-primary"></i>ç«è½¦è½¦æ¬¡ç®¡ç†
        </h2>
        <button id="addTrainBtn" class="btn-ios flex items-center">
          <i class="fa-solid fa-plus mr-1"></i>æ·»åŠ è½¦æ¬¡
        </button>
      </div>
      <!-- ç«è½¦æ·»åŠ è¡¨å• -->
      <form id="trainForm" class="card-ios p-4 mb-6 hidden">
        <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
          <div>
            <label class="block text-sm font-medium text-gray-500 mb-1">è½¦æ¬¡å· <span class="text-red-500">*</span></label>
            <input type="text" name="trainNo" class="input-ios" placeholder="å¦‚ï¼šG1234ã€D5678" required>
          </div>
          <div>
            <label class="block text-sm font-medium text-gray-500 mb-1">å§‹å‘åœ° <span class="text-red-500">*</span></label>
            <input type="text" name="startCity" class="input-ios" placeholder="å¦‚ï¼šé•¿æ˜¥" required>
          </div>
          <div>
            <label class="block text-sm font-medium text-gray-500 mb-1">ç›®çš„åœ° <span class="text-red-500">*</span></label>
            <input type="text" name="endCity" class="input-ios" placeholder="å¦‚ï¼šç§¦çš‡å²›ã€å¤©æ´¥è¥¿" required>
          </div>
          <div>
            <label class="block text-sm font-medium text-gray-500 mb-1">å‡ºå‘æ—¶é—´ <span class="text-red-500">*</span></label>
            <input type="datetime-local" name="startTime" class="input-ios" required>
          </div>
          <div>
            <label class="block text-sm font-medium text-gray-500 mb-1">åˆ°ç«™æ—¶é—´ <span class="text-red-500">*</span></label>
            <input type="datetime-local" name="endTime" class="input-ios" required>
          </div>
          <div>
            <label class="block text-sm font-medium text-gray-500 mb-1">è½¦å¢å·</label>
            <input type="text" name="carriage" class="input-ios" placeholder="å¦‚ï¼š05ã€12">
          </div>
          <div>
            <label class="block text-sm font-medium text-gray-500 mb-1">åº§ä½å· <span class="text-red-500">*</span></label>
            <input type="text" name="seat" class="input-ios" placeholder="å¦‚ï¼š08Aã€15B" required>
          </div>
          <div>
            <label class="block text-sm font-medium text-gray-500 mb-1">ç¥¨ä»·ï¼ˆÂ¥ï¼‰<span class="text-red-500">*</span></label>
            <input type="number" name="price" class="input-ios" placeholder="è¯·è¾“å…¥ç¥¨ä»·" min="0" step="0.01" required>
          </div>
          <div class="md:col-span-2">
            <label class="flex items-center gap-2 text-sm font-medium text-gray-500 mb-1">
              <input type="checkbox" name="isTransfer" class="rounded-ios-sm text-primary">
              ä¸­è½¬è½¦æ¬¡ï¼ˆé•¿æ˜¥â†’è“Ÿå·åŒºä¸“ç”¨ï¼‰
            </label>
            <input type="text" name="transferTo" class="input-ios mt-1 hidden" placeholder="ä¸­è½¬å‰å¾€çš„åŸå¸‚ï¼Œå¦‚ï¼šå¤©æ´¥">
          </div>
          <div class="md:col-span-2">
            <label class="block text-sm font-medium text-gray-500 mb-1">å¤‡æ³¨</label>
            <textarea name="desc" class="input-ios" rows="2" placeholder="è¯·è¾“å…¥å¤‡æ³¨ï¼ˆé€‰å¡«ï¼‰"></textarea>
          </div>
        </div>
        <div class="flex gap-3 mt-4 justify-end">
          <button type="button" id="cancelTrainBtn" class="btn-ios-outline">å–æ¶ˆ</button>
          <button type="submit" class="btn-ios">ä¿å­˜è½¦æ¬¡</button>
        </div>
      </form>
      <!-- ç«è½¦è½¦æ¬¡åˆ—è¡¨ -->
      <div id="trainList" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4">
        <!-- JSåŠ¨æ€ç”Ÿæˆç«è½¦å¡ç‰‡ -->
        <div class="col-span-1 md:col-span-2 lg:col-span-3 flex items-center justify-center py-8 text-gray-400">
          <i class="fa-solid fa-train text-4xl mb-2 opacity-30"></i>
          <p>æš‚æ— ç«è½¦è½¦æ¬¡æ•°æ®ï¼Œç‚¹å‡»ã€Œæ·»åŠ è½¦æ¬¡ã€å¼€å§‹å½•å…¥å§ï½</p>
        </div>
      </div>
    </section>

    <!-- é£æœºæ¨¡å— -->
    <section id="plane" class="tab-content hidden">
      <div class="flex justify-between items-center mb-4">
        <h2 class="text-xl font-bold flex items-center gap-2">
          <i class="fa-solid fa-plane text-primary"></i>é£æœºèˆªç­ç®¡ç†
        </h2>
        <button id="addPlaneBtn" class="btn-ios flex items-center">
          <i class="fa-solid fa-plus mr-1"></i>æ·»åŠ èˆªç­
        </button>
      </div>
      <!-- é£æœºæ·»åŠ è¡¨å• -->
      <form id="planeForm" class="card-ios p-4 mb-6 hidden">
        <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
          <div>
            <label class="block text-sm font-medium text-gray-500 mb-1">èˆªç­å· <span class="text-red-500">*</span></label>
            <input type="text" name="planeNo" class="input-ios" placeholder="å¦‚ï¼šCA1234ã€MU5678" required>
          </div>
          <div>
            <label class="block text-sm font-medium text-gray-500 mb-1">èˆªç©ºå…¬å¸ <span class="text-red-500">*</span></label>
            <input type="text" name="airline" class="input-ios" placeholder="å¦‚ï¼šå›½èˆªã€å—èˆªã€ä¸œèˆª" required>
          </div>
          <div>
            <label class="block text-sm font-medium text-gray-500 mb-1">å‡ºå‘åœ° <span class="text-red-500">*</span></label>
            <input type="text" name="startCity" class="input-ios" placeholder="å¦‚ï¼šé•¿æ˜¥é¾™å˜‰æœºåœº" required>
          </div>
          <div>
            <label class="block text-sm font-medium text-gray-500 mb-1">ç›®çš„åœ° <span class="text-red-500">*</span></label>
            <input type="text" name="endCity" class="input-ios" placeholder="å¦‚ï¼šåŒ—äº¬å¤§å…´æœºåœº" required>
          </div>
          <div>
            <label class="block text-sm font-medium text-gray-500 mb-1">èµ·é£æ—¶é—´ <span class="text-red-500">*</span></label>
            <input type="datetime-local" name="startTime" class="input-ios" required>
          </div>
          <div>
            <label class="block text-sm font-medium text-gray-500 mb-1">é™è½æ—¶é—´ <span class="text-red-500">*</span></label>
            <input type="datetime-local" name="endTime" class="input-ios" required>
          </div>
          <div>
            <label class="block text-sm font-medium text-gray-500 mb-1">åå¸­ç­‰çº§ <span class="text-red-500">*</span></label>
            <select name="seatLevel" class="input-ios" required>
              <option value="ç»æµèˆ±">ç»æµèˆ±</option>
              <option value="å•†åŠ¡èˆ±">å•†åŠ¡èˆ±</option>
              <option value="å¤´ç­‰èˆ±">å¤´ç­‰èˆ±</option>
            </select>
          </div>
          <div>
            <label class="block text-sm font-medium text-gray-500 mb-1">ç¥¨ä»·ï¼ˆÂ¥ï¼‰<span class="text-red-500">*</span></label>
            <input type="number" name="price" class="input-ios" placeholder="è¯·è¾“å…¥ç¥¨ä»·" min="0" step="0.01" required>
          </div>
          <div class="md:col-span-2">
            <label class="flex items-center gap-2 text-sm font-medium text-gray-500 mb-1">
              <input type="checkbox" name="isTransfer" class="rounded-ios-sm text-primary">
              ä¸­è½¬èˆªç­ï¼ˆé•¿æ˜¥â†’è“Ÿå·åŒºä¸“ç”¨ï¼‰
            </label>
            <input type="text" name="transferTo" class="input-ios mt-1 hidden" placeholder="ä¸­è½¬å‰å¾€çš„åŸå¸‚ï¼Œå¦‚ï¼šå¤©æ´¥">
          </div>
          <div class="md:col-span-2">
            <label class="block text-sm font-medium text-gray-500 mb-1">å¤‡æ³¨</label>
            <textarea name="desc" class="input-ios" rows="2" placeholder="è¯·è¾“å…¥å¤‡æ³¨ï¼ˆé€‰å¡«ï¼‰"></textarea>
          </div>
        </div>
        <div class="flex gap-3 mt-4 justify-end">
          <button type="button" id="cancelPlaneBtn" class="btn-ios-outline">å–æ¶ˆ</button>
          <button type="submit" class="btn-ios">ä¿å­˜èˆªç­</button>
        </div>
      </form>
      <!-- é£æœºèˆªç­åˆ—è¡¨ -->
      <div id="planeList" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4">
        <!-- JSåŠ¨æ€ç”Ÿæˆé£æœºå¡ç‰‡ -->
        <div class="col-span-1 md:col-span-2 lg:col-span-3 flex items-center justify-center py-8 text-gray-400">
          <i class="fa-solid fa-plane text-4xl mb-2 opacity-30"></i>
          <p>æš‚æ— é£æœºèˆªç­æ•°æ®ï¼Œç‚¹å‡»ã€Œæ·»åŠ èˆªç­ã€å¼€å§‹å½•å…¥å§ï½</p>
        </div>
      </div>
    </section>

    <!-- é…’åº—æ¨¡å— -->
    <section id="hotel" class="tab-content hidden">
      <div class="flex justify-between items-center mb-4">
        <h2 class="text-xl font-bold flex items-center gap-2">
          <i class="fa-solid fa-hotel text-primary"></i>é…’åº—ä½å®¿ç®¡ç†
        </h2>
        <button id="addHotelBtn" class="btn-ios flex items-center">
          <i class="fa-solid fa-plus mr-1"></i>æ·»åŠ é…’åº—
        </button>
      </div>
      <!-- é…’åº—æ·»åŠ è¡¨å• -->
      <form id="hotelForm" class="card-ios p-4 mb-6 hidden">
        <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
          <div>
            <label class="block text-sm font-medium text-gray-500 mb-1">é…’åº—åç§° <span class="text-red-500">*</span></label>
            <input type="text" name="hotelName" class="input-ios" placeholder="å¦‚ï¼šXXé…’åº—ã€XXæ°‘å®¿" required>
          </div>
          <div>
            <label class="block text-sm font-medium text-gray-500 mb-1">æ‰€åœ¨åŸå¸‚ <span class="text-red-500">*</span></label>
            <input type="text" name="city" class="input-ios" placeholder="å¦‚ï¼šå¤©æ´¥ã€ç§¦çš‡å²›" required>
          </div>
          <div>
            <label class="block text-sm font-medium text-gray-500 mb-1">å…·ä½“ä½ç½®</label>
            <input type="text" name="address" class="input-ios" placeholder="å¦‚ï¼šXXåŒºXXè·¯XXå·">
          </div>
          <div>
            <label class="block text-sm font-medium text-gray-500 mb-1">å…¥ä½æ—¶é—´ <span class="text-red-500">*</span></label>
            <input type="date" name="checkIn" class="input-ios" required>
          </div>
          <div>
            <label class="block text-sm font-medium text-gray-500 mb-1">ç¦»åº—æ—¶é—´ <span class="text-red-500">*</span></label>
            <input type="date" name="checkOut" class="input-ios" required>
          </div>
          <div>
            <label class="block text-sm font-medium text-gray-500 mb-1">æˆ¿å‹ <span class="text-red-500">*</span></label>
            <input type="text" name="roomType" class="input-ios" placeholder="å¦‚ï¼šæ ‡å‡†é—´ã€å¤§åºŠæˆ¿" required>
          </div>
          <div>
            <label class="block text-sm font-medium text-gray-500 mb-1">ä»·æ ¼/æ™šï¼ˆÂ¥ï¼‰<span class="text-red-500">*</span></label>
            <input type="number" name="price" class="input-ios" placeholder="è¯·è¾“å…¥ä»·æ ¼" min="0" step="0.01" required>
          </div>
          <div>
            <label class="block text-sm font-medium text-gray-500 mb-1">è¯„åˆ†</label>
            <select name="score" class="input-ios">
              <option value="5">â˜…â˜…â˜…â˜…â˜…</option>
              <option value="4.5">â˜…â˜…â˜…â˜…â˜†</option>
              <option value="4">â˜…â˜…â˜…â˜…</option>
              <option value="3.5">â˜…â˜…â˜…â˜†</option>
              <option value="3">â˜…â˜…â˜…</option>
            </select>
          </div>
          <div class="md:col-span-2">
            <label class="block text-sm font-medium text-gray-500 mb-1">å¤‡æ³¨</label>
            <textarea name="desc" class="input-ios" rows="2" placeholder="è¯·è¾“å…¥å¤‡æ³¨ï¼ˆé€‰å¡«ï¼‰"></textarea>
          </div>
        </div>
        <div class="flex gap-3 mt-4 justify-end">
          <button type="button" id="cancelHotelBtn" class="btn-ios-outline">å–æ¶ˆ</button>
          <button type="submit" class="btn-ios">ä¿å­˜é…’åº—</button>
        </div>
      </form>
      <!-- é…’åº—åˆ—è¡¨ -->
      <div id="hotelList" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4">
        <!-- JSåŠ¨æ€ç”Ÿæˆé…’åº—å¡ç‰‡ -->
        <div class="col-span-1 md:col-span-2 lg:col-span-3 flex items-center justify-center py-8 text-gray-400">
          <i class="fa-solid fa-hotel text-4xl mb-2 opacity-30"></i>
          <p>æš‚æ— é…’åº—æ•°æ®ï¼Œç‚¹å‡»ã€Œæ·»åŠ é…’åº—ã€å¼€å§‹å½•å…¥å§ï½</p>
        </div>
      </div>
    </section>

    <!-- é¤å…æ¨¡å— -->
    <section id="restaurant" class="tab-content hidden">
      <div class="flex justify-between items-center mb-4">
        <h2 class="text-xl font-bold flex items-center gap-2">
          <i class="fa-solid fa-utensils text-primary"></i>é¤å…ç¾é£Ÿç®¡ç†
        </h2>
        <button id="addRestaurantBtn" class="btn-ios flex items-center">
          <i class="fa-solid fa-plus mr-1"></i>æ·»åŠ é¤å…
        </button>
      </div>
      <!-- é¤å…æ·»åŠ è¡¨å• -->
      <form id="restaurantForm" class="card-ios p-4 mb-6 hidden">
        <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
          <div>
            <label class="block text-sm font-medium text-gray-500 mb-1">é¤å…åç§° <span class="text-red-500">*</span></label>
            <input type="text" name="restName" class="input-ios" placeholder="å¦‚ï¼šXXç«é”…ã€XXå°åƒ" required>
          </div>
          <div>
            <label class="block text-sm font-medium text-gray-500 mb-1">æ‰€å±åŸå¸‚ <span class="text-red-500">*</span></label>
            <input type="text" name="city" class="input-ios" placeholder="å¦‚ï¼šé•¿æ˜¥ã€å¤©æ´¥ã€è“Ÿå·åŒº" required>
          </div>
          <div>
            <label class="block text-sm font-medium text-gray-500 mb-1">å…·ä½“åœ°å€</label>
            <input type="text" name="address" class="input-ios" placeholder="å¦‚ï¼šXXåŒºXXè·¯XXå·">
          </div>
          <div>
            <label class="block text-sm font-medium text-gray-500 mb-1">äººå‡æ¶ˆè´¹ï¼ˆÂ¥ï¼‰<span class="text-red-500">*</span></label>
            <input type="number" name="perPrice" class="input-ios" placeholder="è¯·è¾“å…¥äººå‡" min="0" step="0.01" required>
          </div>
          <div>
            <label class="block text-sm font-medium text-gray-500 mb-1">è¯„åˆ†</label>
            <select name="score" class="input-ios">
              <option value="5">â˜…â˜…â˜…â˜…â˜…</option>
              <option value="4.5">â˜…â˜…â˜…â˜…â˜†</option>
              <option value="4">â˜…â˜…â˜…â˜…</option>
              <option value="3.5">â˜…â˜…â˜…â˜†</option>
              <option value="3">â˜…â˜…â˜…</option>
            </select>
          </div>
          <div>
            <label class="block text-sm font-medium text-gray-500 mb-1">æ¨èèœå“</label>
            <input type="text" name="recommend" class="input-ios" placeholder="å¦‚ï¼šç•ªèŒ„é”…åº•ã€æ‹›ç‰Œçƒ§è…Š">
          </div>
          <div class="md:col-span-2">
            <label class="block text-sm font-medium text-gray-500 mb-1">å¤‡æ³¨</label>
            <textarea name="desc" class="input-ios" rows="2" placeholder="è¯·è¾“å…¥å¤‡æ³¨ï¼ˆé€‰å¡«ï¼‰"></textarea>
          </div>
        </div>
        <div class="flex gap-3 mt-4 justify-end">
          <button type="button" id="cancelRestaurantBtn" class="btn-ios-outline">å–æ¶ˆ</button>
          <button type="submit" class="btn-ios">ä¿å­˜é¤å…</button>
        </div>
      </form>
      <!-- é¤å…åˆ—è¡¨ -->
      <div id="restaurantList" class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-4">
        <!-- JSåŠ¨æ€ç”Ÿæˆé¤å…å¡ç‰‡ -->
        <div class="col-span-1 sm:col-span-2 lg:col-span-3 xl:col-span-4 flex items-center justify-center py-8 text-gray-400">
          <i class="fa-solid fa-utensils text-4xl mb-2 opacity-30"></i>
          <p>æš‚æ— é¤å…æ•°æ®ï¼Œç‚¹å‡»ã€Œæ·»åŠ é¤å…ã€å¼€å§‹å½•å…¥å§ï½</p>
        </div>
      </div>
    </section>

    <!-- æ™¯ç‚¹æ¨¡å— -->
    <section id="scenic" class="tab-content hidden">
      <div class="flex justify-between items-center mb-4">
        <h2 class="text-xl font-bold flex items-center gap-2">
          <i class="fa-solid fa-mountain-sun text-primary"></i>æ™¯ç‚¹é—¨ç¥¨ç®¡ç†
        </h2>
        <button id="addScenicBtn" class="btn-ios flex items-center">
          <i class="fa-solid fa-plus mr-1"></i>æ·»åŠ æ™¯ç‚¹
        </button>
      </div>
      <!-- æ™¯ç‚¹æ·»åŠ è¡¨å• -->
      <form id="scenicForm" class="card-ios p-4 mb-6 hidden">
        <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
          <div>
            <label class="block text-sm font-medium text-gray-500 mb-1">æ™¯ç‚¹åç§° <span class="text-red-500">*</span></label>
            <input type="text" name="scenicName" class="input-ios" placeholder="å¦‚ï¼šXXå…¬å›­ã€XXå¤é•‡" required>
          </div>
          <div>
            <label class="block text-sm font-medium text-gray-500 mb-1">æ‰€å±åŸå¸‚ <span class="text-red-500">*</span></label>
            <input type="text" name="city" class="input-ios" placeholder="å¦‚ï¼šå¤©æ´¥ã€è“Ÿå·åŒºã€åŒ—äº¬" required>
          </div>
          <div>
            <label class="block text-sm font-medium text-gray-500 mb-1">å…·ä½“åœ°å€</label>
            <input type="text" name="address" class="input-ios" placeholder="å¦‚ï¼šXXåŒºXXè·¯XXå·">
          </div>
          <div>
            <label class="block text-sm font-medium text-gray-500 mb-1">é—¨ç¥¨ä»·æ ¼ï¼ˆÂ¥ï¼‰<span class="text-red-500">*</span></label>
            <input type="number" name="ticketPrice" class="input-ios" placeholder="å…è´¹å¡«0" min="0" step="0.01" required>
          </div>
          <div>
            <label class="block text-sm font-medium text-gray-500 mb-1">è¯„åˆ†</label>
            <select name="score" class="input-ios">
              <option value="5">â˜…â˜…â˜…â˜…â˜…</option>
              <option value="4.5">â˜…â˜…â˜…â˜…â˜†</option>
              <option value="4">â˜…â˜…â˜…â˜…</option>
              <option value="3.5">â˜…â˜…â˜…â˜†</option>
              <option value="3">â˜…â˜…â˜…</option>
            </select>
          </div>
          <div>
            <label class="block text-sm font-medium text-gray-500 mb-1">æ¸¸ç©æ—¶é•¿ï¼ˆå°æ—¶ï¼‰</label>
            <input type="number" name="playTime" class="input-ios" placeholder="å¦‚ï¼š2ã€3.5" min="0" step="0.5">
          </div>
          <div class="md:col-span-2">
            <label class="block text-sm font-medium text-gray-500 mb-1">å¤‡æ³¨</label>
            <textarea name="desc" class="input-ios" rows="2" placeholder="è¯·è¾“å…¥å¤‡æ³¨ï¼ˆé€‰å¡«ï¼‰"></textarea>
          </div>
        </div>
        <div class="flex gap-3 mt-4 justify-end">
          <button type="button" id="cancelScenicBtn" class="btn-ios-outline">å–æ¶ˆ</button>
          <button type="submit" class="btn-ios">ä¿å­˜æ™¯ç‚¹</button>
        </div>
      </form>
      <!-- æ™¯ç‚¹åˆ—è¡¨ -->
      <div id="scenicList" class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-4">
        <!-- JSåŠ¨æ€ç”Ÿæˆæ™¯ç‚¹å¡ç‰‡ -->
        <div class="col-span-1 sm:col-span-2 lg:col-span-3 xl:col-span-4 flex items-center justify-center py-8 text-gray-400">
          <i class="fa-solid fa-mountain-sun text-4xl mb-2 opacity-30"></i>
          <p>æš‚æ— æ™¯ç‚¹æ•°æ®ï¼Œç‚¹å‡»ã€Œæ·»åŠ æ™¯ç‚¹ã€å¼€å§‹å½•å…¥å§ï½</p>
        </div>
      </div>
    </section>

    <!-- åŸå¸‚è·¯çº¿æ¨¡å—ï¼šæ ¸å¿ƒæ¨¡å— -->
    <section id="route" class="tab-content hidden">
      <div class="flex justify-between items-center mb-6">
        <h2 class="text-xl font-bold flex items-center gap-2">
          <i class="fa-solid fa-map-location-dot text-primary"></i>åŸå¸‚è·¯çº¿è§„åˆ’ï¼ˆé•¿æ˜¥â†’è“Ÿå·åŒºï¼‰
        </h2>
        <div class="text-sm text-gray-500">
          è·¯çº¿ä¸»çº¿è‡ªåŠ¨åŒæ­¥ç«è½¦/é£æœºäº¤é€šä¿¡æ¯ | èŠ‚ç‚¹å¯æ·»åŠ æ™¯ç‚¹/é¤å…åˆ†æ”¯
        </div>
      </div>
      <!-- è·¯çº¿å¯è§†åŒ–ï¼šä¸»çº¿+åˆ†æ”¯ -->
      <div class="card-ios p-6 mb-6">
        <div class="flex flex-col md:flex-row items-start md:items-center justify-center relative">
          <!-- è·¯çº¿ä¸»çº¿ï¼šé•¿æ˜¥ â†’ ä¸­è½¬åœ° â†’ å¤©æ´¥ â†’ è“Ÿå·åŒº -->
          <div id="routeMain" class="w-full flex flex-col md:flex-row items-center justify-between gap-6 md:gap-0 relative">
            <!-- åŠ¨æ€ç”Ÿæˆä¸»çº¿èŠ‚ç‚¹ï¼šJSå®ç° -->
          </div>
        </div>
      </div>
      <!-- è‡ªå®šä¹‰åˆ†ç±»åˆ—è¡¨ -->
      <div class="mb-4">
        <h3 class="text-lg font-semibold flex items-center gap-2 mb-3">
          <i class="fa-solid fa-list-ul text-primary"></i>è‡ªå®šä¹‰é¢„ç®—åˆ†ç±»
        </h3>
        <div id="customList" class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4">
          <!-- JSåŠ¨æ€ç”Ÿæˆè‡ªå®šä¹‰åˆ†ç±»å¡ç‰‡ -->
          <div class="col-span-1 sm:col-span-2 lg:col-span-3 flex items-center justify-center py-4 text-gray-400 text-sm">
            æš‚æ— è‡ªå®šä¹‰åˆ†ç±»ï¼Œç‚¹å‡»å³ä¸Šè§’ã€Œè‡ªå®šä¹‰ã€æ·»åŠ å§ï½
          </div>
        </div>
      </div>
    </section>
  </main>

  <!-- åº•éƒ¨ä¿¡æ¯ -->
  <footer class="bg-white shadow-sm py-4 mt-6">
    <div class="container mx-auto px-4 text-center text-gray-400 text-sm">
      <p>æ—…è¡Œé¢„ç®—ç®¡ç† Â© 2025 | iOSé£æ ¼è‡ªé€‚åº”ç‰ˆ | æ•°æ®å­˜å‚¨äºæœ¬åœ°æµè§ˆå™¨ï¼Œè¯·å‹¿æ¸…é™¤ç¼“å­˜</p>
    </div>
  </footer>

  <script>
    // ===================== æ ¸å¿ƒå·¥å…·å‡½æ•°ï¼šæœ¬åœ°å­˜å‚¨ =====================
    const Storage = {
      // è·å–æ•°æ®
      get(key) {
        const data = localStorage.getItem(`travel_${key}`);
        return data ? JSON.parse(data) : [];
      },
      // ä¿å­˜æ•°æ®
      set(key, data) {
        localStorage.setItem(`travel_${key}`, JSON.stringify(data));
        // æ•°æ®å˜åŒ–ååˆ·æ–°æ‰€æœ‰é¡µé¢
        renderAll();
      },
      // åˆ é™¤æ•°æ®
      remove(key, id) {
        const data = this.get(key);
        const newData = data.filter(item => item.id !== id);
        this.set(key, newData);
      },
      // ç”Ÿæˆå”¯ä¸€IDï¼šæ—¶é—´æˆ³
      genId() {
        return new Date().getTime();
      }
    };

    // ===================== å…¨å±€å˜é‡ =====================
    // ä¸­è½¬åœ°åˆ—è¡¨ï¼šé•¿æ˜¥â†’è“Ÿå·åŒºä¸“ç”¨
    const transferCities = ['ç§¦çš‡å²›', 'å¤©æ´¥è¥¿', 'åŒ—äº¬'];
    // è·¯çº¿ä¸»èŠ‚ç‚¹ï¼šå›ºå®šé•¿æ˜¥â†’ä¸­è½¬åœ°â†’å¤©æ´¥â†’è“Ÿå·åŒº
    const routeMainCities = ['é•¿æ˜¥', 'ä¸­è½¬åœ°', 'å¤©æ´¥', 'è“Ÿå·åŒº'];

    // ===================== é¡µé¢åˆå§‹åŒ–ï¼šæ ‡ç­¾åˆ‡æ¢ + äº‹ä»¶ç»‘å®š =====================
    document.addEventListener('DOMContentLoaded', function() {
      // æ ‡ç­¾åˆ‡æ¢ï¼šç”µè„‘/å¹³æ¿
      const tabLinks = document.querySelectorAll('.tab-link');
      const tabContents = document.querySelectorAll('.tab-content');
      tabLinks.forEach(link => {
        link.addEventListener('click', function(e) {
          e.preventDefault();
          // ç§»é™¤æ‰€æœ‰æ¿€æ´»çŠ¶æ€
          tabLinks.forEach(l => l.classList.remove('tab-active'));
          tabContents.forEach(c => c.classList.add('hidden'));
          // æ·»åŠ å½“å‰æ¿€æ´»çŠ¶æ€
          this.classList.add('tab-active');
          const target = this.getAttribute('href').slice(1);
          document.getElementById(target).classList.remove('hidden');
          // å…³é—­æ±‰å ¡èœå•
          document.getElementById('hamburgerMenu').classList.add('hidden');
        });
      });

      // æ±‰å ¡èœå•ï¼šæ‰‹æœºç«¯
      const hamburgerBtn = document.getElementById('hamburgerBtn');
      const hamburgerMenu = document.getElementById('hamburgerMenu');
      const hamburgerTabs = document.querySelectorAll('.hamburger-tab');
      hamburgerBtn.addEventListener('click', () => {
        hamburgerMenu.classList.toggle('hidden');
      });
      hamburgerTabs.forEach(tab => {
        tab.addEventListener('click', function() {
          const target = this.getAttribute('href')?.slice(1) || (this.textContent.includes('å¯¹æ¯”') ? 'compare' : '');
          if (target === 'compare') {
            openCompareModal();
          } else if (target) {
            // åˆ‡æ¢æ ‡ç­¾
            tabLinks.forEach(l => l.classList.remove('tab-active'));
            tabContents.forEach(c => c.classList.add('hidden'));
            document.querySelector(`.tab-link[href="#${target}"]`).classList.add('tab-active');
            document.getElementById(target).classList.remove('hidden');
          }
          hamburgerMenu.classList.add('hidden');
        });
      });

      // å¯¹æ¯”å¼¹çª—
      document.getElementById('compareBtn').addEventListener('click', openCompareModal);
      document.getElementById('closeCompareModal').addEventListener('click', () => {
        document.getElementById('compareModal').classList.add('hidden');
      });
      // å¯¹æ¯”ç±»å‹åˆ‡æ¢
      document.querySelectorAll('.compare-type-btn').forEach(btn => {
        btn.addEventListener('click', function() {
          const type = this.getAttribute('data-type');
          // åˆ‡æ¢æŒ‰é’®çŠ¶æ€
          document.querySelectorAll('.compare-type-btn').forEach(b => {
            b.classList.remove('btn-ios');
            b.classList.add('btn-ios-outline');
          });
          this.classList.remove('btn-ios-outline');
          this.classList.add('btn-ios');
          // åˆ‡æ¢è¡¨æ ¼
          document.getElementById('trainCompareTable').classList.toggle('hidden', type !== 'train');
          document.getElementById('planeCompareTable').classList.toggle('hidden', type !== 'plane');
          // åˆ·æ–°å¯¹æ¯”æ•°æ®
          type === 'train' ? renderTrainCompare() : renderPlaneCompare();
        });
      });

      // è‡ªå®šä¹‰åˆ†ç±»å¼¹çª—
      document.getElementById('addCustomBtn').addEventListener('click', () => {
        document.getElementById('customModal').classList.remove('hidden');
      });
      document.getElementById('closeCustomModal').addEventListener('click', () => {
        document.getElementById('customModal').classList.add('hidden');
        document.getElementById('customForm').reset();
      });
      // è‡ªå®šä¹‰åˆ†ç±»è¡¨å•æäº¤
      document.getElementById('customForm').addEventListener('submit', function(e) {
        e.preventDefault();
        const formData = new FormData(this);
        const custom = {
          id: Storage.genId(),
          name: formData.get('customName'),
          icon: formData.get('customIcon'),
          price: Number(formData.get('customPrice')),
          desc: formData.get('customDesc') || ''
        };
        const customs = Storage.get('custom');
        customs.push(custom);
        Storage.set('custom', customs);
        this.reset();
        document.getElementById('customModal').classList.add('hidden');
        alert('è‡ªå®šä¹‰åˆ†ç±»æ·»åŠ æˆåŠŸï¼');
      });

      // ===================== å„æ¨¡å—è¡¨å•äº‹ä»¶ç»‘å®š =====================
      // 1. ç«è½¦æ¨¡å—
      bindFormEvent('train', ['trainNo', 'startCity', 'endCity', 'startTime', 'endTime', 'carriage', 'seat', 'price', 'isTransfer', 'transferTo', 'desc']);
      // ä¸­è½¬è½¦æ¬¡å‹¾é€‰æ˜¾ç¤ºè¾“å…¥æ¡†
      document.querySelector('input[name="isTransfer"]').addEventListener('change', function() {
        const transferInput = document.querySelector('input[name="transferTo"]');
        this.checked ? transferInput.classList.remove('hidden') : transferInput.classList.add('hidden');
      });

      // 2. é£æœºæ¨¡å—
      bindFormEvent('plane', ['planeNo', 'airline', 'startCity', 'endCity', 'startTime', 'endTime', 'seatLevel', 'price', 'isTransfer', 'transferTo', 'desc']);
      document.querySelector('#planeForm input[name="isTransfer"]').addEventListener('change', function() {
        const transferInput = document.querySelector('#planeForm input[name="transferTo"]');
        this.checked ? transferInput.classList.remove('hidden') : transferInput.classList.add('hidden');
      });

      // 3. é…’åº—æ¨¡å—
      bindFormEvent('hotel', ['hotelName', 'city', 'address', 'checkIn', 'checkOut', 'roomType', 'price', 'score', 'desc']);

      // 4. é¤å…æ¨¡å—
      bindFormEvent('restaurant', ['restName', 'city', 'address', 'perPrice', 'score', 'recommend', 'desc']);

      // 5. æ™¯ç‚¹æ¨¡å—
      bindFormEvent('scenic', ['scenicName', 'city', 'address', 'ticketPrice', 'score', 'playTime', 'desc']);

      // åˆå§‹åŒ–æ¸²æŸ“æ‰€æœ‰é¡µé¢
      renderAll();
      // é»˜è®¤æ˜¾ç¤ºè·¯çº¿é¡µé¢
      tabLinks.forEach(l => l.classList.remove('tab-active'));
      tabContents.forEach(c => c.classList.add('hidden'));
      document.querySelector('.tab-link[href="#route"]').classList.add('tab-active');
      document.getElementById('route').classList.remove('hidden');
    });

    // ===================== é€šç”¨å‡½æ•°ï¼šè¡¨å•äº‹ä»¶ç»‘å®š =====================
    function bindFormEvent(type, fields) {
      const addBtn = document.getElementById(`add${type.charAt(0).toUpperCase() + type.slice(1)}Btn`);
      const cancelBtn = document.getElementById(`cancel${type.charAt(0).toUpperCase() + type.slice(1)}Btn`);
      const form = document.getElementById(`${type}Form`);
      const formFields = fields.map(f => form.querySelector(`input[name="${f}"]`) || form.querySelector(`select[name="${f}"]`));

      // æ˜¾ç¤º/éšè—è¡¨å•
      addBtn.addEventListener('click', () => {
        form.classList.remove('hidden');
        form.reset();
        // é‡ç½®ä¸­è½¬è¾“å…¥æ¡†
        const isTransfer = form.querySelector('input[name="isTransfer"]');
        if (isTransfer) {
          isTransfer.checked = false;
          const transferTo = form.querySelector('input[name="transferTo"]');
          transferTo.classList.add('hidden');
        }
      });
      cancelBtn.addEventListener('click', () => {
        form.classList.add('hidden');
        form.reset();
      });

      // è¡¨å•æäº¤
      form.addEventListener('submit', function(e) {
        e.preventDefault();
        const formData = new FormData(this);
        const data = { id: Storage.genId() };
        fields.forEach(field => {
          const value = formData.get(field);
          // å¤„ç†å¸ƒå°”å€¼ï¼ˆä¸­è½¬è½¦æ¬¡ï¼‰
          if (field === 'isTransfer') {
            data[field] = formData.get(field) === 'on';
          }
          // å¤„ç†æ•°å­—ï¼ˆä»·æ ¼ã€è¯„åˆ†ç­‰ï¼‰
          else if (['price', 'perPrice', 'ticketPrice', 'score', 'playTime'].includes(field)) {
            data[field] = value ? Number(value) : 0;
          }
          else {
            data[field] = value || '';
          }
        });
        // ä¿å­˜æ•°æ®
        const list = Storage.get(type);
        list.push(data);
        Storage.set(type, list);
        // éšè—è¡¨å•å¹¶é‡ç½®
        form.classList.add('hidden');
        form.reset();
        alert(`${type === 'train' ? 'è½¦æ¬¡' : type === 'plane' ? 'èˆªç­' : type === 'hotel' ? 'é…’åº—' : type === 'restaurant' ? 'é¤å…' : 'æ™¯ç‚¹'}æ·»åŠ æˆåŠŸï¼`);
      });
    }

    // ===================== é€šç”¨å‡½æ•°ï¼šæ¸²æŸ“æ‰€æœ‰é¡µé¢ =====================
    function renderAll() {
      renderTrain();
      renderPlane();
      renderHotel();
      renderRestaurant();
      renderScenic();
      renderRoute();
      renderCustom();
      renderTrainCompare();
      renderPlaneCompare();
    }

    // ===================== æ¨¡å—æ¸²æŸ“ï¼šç«è½¦ =====================
    function renderTrain() {
      const trainList = document.getElementById('trainList');
      const trains = Storage.get('train');
      if (trains.length === 0) {
        trainList.innerHTML = `
          <div class="col-span-1 md:col-span-2 lg:col-span-3 flex flex-col items-center justify-center py-8 text-gray-400">
            <i class="fa-solid fa-train text-4xl mb-2 opacity-30"></i>
            <p>æš‚æ— ç«è½¦è½¦æ¬¡æ•°æ®ï¼Œç‚¹å‡»ã€Œæ·»åŠ è½¦æ¬¡ã€å¼€å§‹å½•å…¥å§ï½</p>
          </div>
        `;
        return;
      }
      trainList.innerHTML = trains.map(train => `
        <div class="card-ios p-4 hover:translate-y-[-2px] transition-transform duration-200">
          <div class="flex justify-between items-start mb-2">
            <h3 class="text-lg font-bold text-primary">${train.trainNo}</h3>
            <button class="text-gray-400 hover:text-red-500" onclick="Storage.remove('train', ${train.id})">
              <i class="fa-solid fa-trash"></i>
            </button>
          </div>
          <div class="grid grid-cols-2 gap-2 text-sm">
            <div><span class="text-gray-500">å§‹å‘åœ°ï¼š</span>${train.startCity}</div>
            <div><span class="text-gray-500">ç›®çš„åœ°ï¼š</span>${train.endCity}</div>
            <div><span class="text-gray-500">å‡ºå‘æ—¶é—´ï¼š</span>${formatTime(train.startTime)}</div>
            <div><span class="text-gray-500">åˆ°ç«™æ—¶é—´ï¼š</span>${formatTime(train.endTime)}</div>
            <div><span class="text-gray-500">è½¦å¢/åº§ä½ï¼š</span>${train.carriage || 'æœªå¡«å†™'}/${train.seat}</div>
            <div><span class="text-gray-500">ç¥¨ä»·ï¼š</span>Â¥${train.price.toFixed(2)}</div>
            ${train.isTransfer ? `<div class="col-span-2 text-xs text-primary bg-primary/10 py-1 px-2 rounded-ios-sm">
              ğŸ“ ä¸­è½¬è½¦æ¬¡ï¼šå‰å¾€${train.transferTo}
            </div>` : ''}
            ${train.desc ? `<div class="col-span-2 mt-2 text-sm"><span class="text-gray-500">å¤‡æ³¨ï¼š</span>${train.desc}</div>` : ''}
          </div>
        </div>
      `).join('');
    }

    // ===================== æ¨¡å—æ¸²æŸ“ï¼šé£æœº =====================
    function renderPlane() {
      const planeList = document.getElementById('planeList');
      const planes = Storage.get('plane');
      if (planes.length === 0) {
        planeList.innerHTML = `
          <div class="col-span-1 md:col-span-2 lg:col-span-3 flex flex-col items-center justify-center py-8 text-gray-400">
            <i class="fa-solid fa-plane text-4xl mb-2 opacity-30"></i>
            <p>æš‚æ— é£æœºèˆªç­æ•°æ®ï¼Œç‚¹å‡»ã€Œæ·»åŠ èˆªç­ã€å¼€å§‹å½•å…¥å§ï½</p>
          </div>
        `;
        return;
      }
      planeList.innerHTML = planes.map(plane => `
        <div class="card-ios p-4 hover:translate-y-[-2px] transition-transform duration-200">
          <div class="flex justify-between items-start mb-2">
            <h3 class="text-lg font-bold text-primary">${plane.planeNo} | ${plane.airline}</h3>
            <button class="text-gray-400 hover:text-red-500" onclick="Storage.remove('plane', ${plane.id})">
              <i class="fa-solid fa-trash"></i>
            </button>
          </div>
          <div class="grid grid-cols-2 gap-2 text-sm">
            <div><span class="text-gray-500">å‡ºå‘åœ°ï¼š</span>${plane.startCity}</div>
            <div><span class="text-gray-500">ç›®çš„åœ°ï¼š</span>${plane.endCity}</div>
            <div><span class="text-gray-500">èµ·é£æ—¶é—´ï¼š</span>${formatTime(plane.startTime)}</div>
            <div><span class="text-gray-500">é™è½æ—¶é—´ï¼š</span>${formatTime(plane.endTime)}</div>
            <div><span class="text-gray-500">åå¸­ç­‰çº§ï¼š</span>${plane.seatLevel}</div>
            <div><span class="text-gray-500">ç¥¨ä»·ï¼š</span>Â¥${plane.price.toFixed(2)}</div>
            ${plane.isTransfer ? `<div class="col-span-2 text-xs text-primary bg-primary/10 py-1 px-2 rounded-ios-sm">
              ğŸ“ ä¸­è½¬èˆªç­ï¼šå‰å¾€${plane.transferTo}
            </div>` : ''}
            ${plane.desc ? `<div class="col-span-2 mt-2 text-sm"><span class="text-gray-500">å¤‡æ³¨ï¼š</span>${plane.desc}</div>` : ''}
          </div>
        </div>
      `).join('');
    }

    // ===================== æ¨¡å—æ¸²æŸ“ï¼šé…’åº— =====================
    function renderHotel() {
      const hotelList = document.getElementById('hotelList');
      const hotels = Storage.get('hotel');
      if (hotels.length === 0) {
        hotelList.innerHTML = `
          <div class="col-span-1 md:col-span-2 lg:col-span-3 flex flex-col items-center justify-center py-8 text-gray-400">
            <i class="fa-solid fa-hotel text-4xl mb-2 opacity-30"></i>
            <p>æš‚æ— é…’åº—æ•°æ®ï¼Œç‚¹å‡»ã€Œæ·»åŠ é…’åº—ã€å¼€å§‹å½•å…¥å§ï½</p>
          </div>
        `;
        return;
      }
      hotelList.innerHTML = hotels.map(hotel => `
        <div class="card-ios p-4 hover:translate-y-[-2px] transition-transform duration-200">
          <div class="flex justify-between items-start mb-2">
            <h3 class="text-lg font-bold text-primary">${hotel.hotelName}</h3>
            <button class="text-gray-400 hover:text-red-500" onclick="Storage.remove('hotel', ${hotel.id})">
              <i class="fa-solid fa-trash"></i>
            </button>
          </div>
          <div class="grid grid-cols-2 gap-2 text-sm">
            <div><span class="text-gray-500">åŸå¸‚ï¼š</span>${hotel.city}</div>
            <div><span class="text-gray-500">ä½ç½®ï¼š</span>${hotel.address || 'æœªå¡«å†™'}</div>
            <div><span class="text-gray-500">å…¥ä½ï¼š</span>${formatDate(hotel.checkIn)}</div>
            <div><span class="text-gray-500">ç¦»åº—ï¼š</span>${formatDate(hotel.checkOut)}</div>
            <div><span class="text-gray-500">æˆ¿å‹ï¼š</span>${hotel.roomType}</div>
            <div><span class="text-gray-500">ä»·æ ¼/æ™šï¼š</span>Â¥${hotel.price.toFixed(2)}</div>
            <div><span class="text-gray-500">è¯„åˆ†ï¼š</span>${hotel.score}â˜…</div>
            <div><span class="text-gray-500">å…¥ä½å¤©æ•°ï¼š</span>${calcDays(hotel.checkIn, hotel.checkOut)}å¤©</div>
            ${hotel.desc ? `<div class="col-span-2 mt-2 text-sm"><span class="text-gray-500">å¤‡æ³¨ï¼š</span>${hotel.desc}</div>` : ''}
          </div>
        </div>
      `).join('');
    }

    // ===================== æ¨¡å—æ¸²æŸ“ï¼šé¤å… =====================
    function renderRestaurant() {
      const restaurantList = document.getElementById('restaurantList');
      const restaurants = Storage.get('restaurant');
      if (restaurants.length === 0) {
        restaurantList.innerHTML = `
          <div class="col-span-1 sm:col-span-2 lg:col-span-3 xl:col-span-4 flex flex-col items-center justify-center py-8 text-gray-400">
            <i class="fa-solid fa-utensils text-4xl mb-2 opacity-30"></i>
            <p>æš‚æ— é¤å…æ•°æ®ï¼Œç‚¹å‡»ã€Œæ·»åŠ é¤å…ã€å¼€å§‹å½•å…¥å§ï½</p>
          </div>
        `;
        return;
      }
      restaurantList.innerHTML = restaurants.map(rest => `
        <div class="card-ios p-4 hover:translate-y-[-2px] transition-transform duration-200">
          <div class="flex justify-between items-start mb-2">
            <h3 class="font-bold text-primary">${rest.restName}</h3>
            <button class="text-gray-400 hover:text-red-500" onclick="Storage.remove('restaurant', ${rest.id})">
              <i class="fa-solid fa-trash text-xs"></i>
            </button>
          </div>
          <div class="text-sm space-y-1">
          <p><span class="text-gray-500">åŸå¸‚ï¼š</span>${rest.city}</p>
          <p><span class="text-gray-500">åœ°å€ï¼š</span>${rest.address || 'æœªå¡«å†™'}</p>
          <p><span class="text-gray-500">äººå‡ï¼š</span>Â¥${rest.perPrice.toFixed(2)}</p>
          <p><span class="text-gray-500">è¯„åˆ†ï¼š</span>${rest.score}â˜…</p>
          ${rest.recommend ? `<p><span class="text-gray-500">æ¨èï¼š</span>${rest.recommend}</p>` : ''}
          ${rest.desc ? `<p class="mt-1 text-xs text-gray-500">${rest.desc}</p>` : ''}
        </div>
      </div>
      `).join('');
    }

    // ===================== æ¨¡å—æ¸²æŸ“ï¼šæ™¯ç‚¹ =====================
    function renderScenic() {
      const scenicList = document.getElementById('scenicList');
      const scenics = Storage.get('scenic');
      if (scenics.length === 0) {
        scenicList.innerHTML = `
          <div class="col-span-1 sm:col-span-2 lg:col-span-3 xl:col-span-4 flex flex-col items-center justify-center py-8 text-gray-400">
            <i class="fa-solid fa-mountain-sun text-4xl mb-2 opacity-30"></i>
            <p>æš‚æ— æ™¯ç‚¹æ•°æ®ï¼Œç‚¹å‡»ã€Œæ·»åŠ æ™¯ç‚¹ã€å¼€å§‹å½•å…¥å§ï½</p>
          </div>
        `;
        return;
      }
      scenicList.innerHTML = scenics.map(scenic => `
        <div class="card-ios p-4 hover:translate-y-[-2px] transition-transform duration-200">
          <div class="flex justify-between items-start mb-2">
            <h3 class="font-bold text-primary">${scenic.scenicName}</h3>
            <button class="text-gray-400 hover:text-red-500" onclick="Storage.remove('scenic', ${scenic.id})">
              <i class="fa-solid fa-trash text-xs"></i>
            </button>
          </div>
          <div class="text-sm space-y-1">
            <p><span class="text-gray-500">åŸå¸‚ï¼š</span>${scenic.city}</p>
            <p><span class="text-gray-500">åœ°å€ï¼š</span>${scenic.address || 'æœªå¡«å†™'}</p>
            <p><span class="text-gray-500">é—¨ç¥¨ï¼š</span>Â¥${scenic.ticketPrice.toFixed(2)}</p>
            <p><span class="text-gray-500">è¯„åˆ†ï¼š</span>${scenic.score}â˜…</p>
            ${scenic.playTime ? `<p><span class="text-gray-500">æ¸¸ç©ï¼š</span>${scenic.playTime}å°æ—¶</p>` : ''}
            ${scenic.desc ? `<p class="mt-1 text-xs text-gray-500">${scenic.desc}</p>` : ''}
          </div>
        </div>
      `).join('');
    }

    // ===================== æ¨¡å—æ¸²æŸ“ï¼šåŸå¸‚è·¯çº¿ï¼ˆæ ¸å¿ƒï¼‰=====================
    function renderRoute() {
      const routeMain = document.getElementById('routeMain');
      const trains = Storage.get('train');
      const planes = Storage.get('plane');
      const scenics = Storage.get('scenic');
      const restaurants = Storage.get('restaurant');
      // è¿‡æ»¤ä¸­è½¬äº¤é€šæ•°æ®ï¼šé•¿æ˜¥â†’ä¸­è½¬åœ°ã€ä¸­è½¬åœ°â†’å¤©æ´¥
      const transferTrains = trains.filter(t => t.isTransfer);
      const transferPlanes = planes.filter(t => t.isTransfer);

      // ç”Ÿæˆè·¯çº¿ä¸»èŠ‚ç‚¹ï¼šé•¿æ˜¥ â†’ ä¸­è½¬åœ° â†’ å¤©æ´¥ â†’ è“Ÿå·åŒº
      routeMain.innerHTML = routeMainCities.map((city, index) => {
        // è·å–å½“å‰åŸå¸‚çš„äº¤é€š/æ™¯ç‚¹/é¤å…æ•°æ®
        let trafficHtml = '';
        let scenicHtml = '';
        let restaurantHtml = '';
        let nodeClass = 'flex flex-col items-center w-full md:w-1/4';

        // 1. é•¿æ˜¥èŠ‚ç‚¹ï¼šä»…å±•ç¤ºé•¿æ˜¥â†’ä¸­è½¬åœ°çš„äº¤é€š
        if (city === 'é•¿æ˜¥') {
          const toTransfer = [...transferTrains, ...transferPlanes].filter(t => t.startCity === 'é•¿æ˜¥');
          trafficHtml = toTransfer.length > 0 ? `
            <div class="mt-2 w-full bg-light rounded-ios-sm p-2 text-xs">
              <p class="font-medium text-center mb-1">å‡ºå‘äº¤é€š</p>
              ${toTransfer.map(t => `
                <div class="flex justify-between items-center py-1 border-b border-gray-100 last:border-0">
                  <span>${t.trainNo ? `ğŸš ${t.trainNo}` : `âœˆï¸ ${t.planeNo}(${t.airline})`}</span>
                  <span>${t.endCity} | Â¥${t.price.toFixed(2)}</span>
                </div>
              `).join('')}
            </div>
          ` : '<p class="mt-2 text-xs text-gray-400">æš‚æ— å‡ºå‘äº¤é€šæ•°æ®</p>';
        }

        // 2. ä¸­è½¬åœ°èŠ‚ç‚¹ï¼šå±•ç¤ºå¯é€‰ä¸­è½¬åœ°+é•¿æ˜¥â†’ä¸­è½¬ã€ä¸­è½¬â†’å¤©æ´¥çš„äº¤é€š
        if (city === 'ä¸­è½¬åœ°') {
          trafficHtml = `
            <div class="mt-2 w-full bg-light rounded-ios-sm p-2 text-xs">
              <p class="font-medium text-center mb-1">ä¸­è½¬é€‰æ‹©ï¼ˆ${transferCities.join(' / ')}ï¼‰</p>
              ${transferTrains.length + transferPlanes.length > 0 ? `
                <p class="text-center text-primary text-xs mb-1">å·²æ·»åŠ ${transferTrains.length}è½¦æ¬¡+${transferPlanes.length}èˆªç­</p>
              ` : '<p class="text-center text-gray-400 text-xs">æš‚æ— ä¸­è½¬äº¤é€šæ•°æ®</p>'}
            </div>
          `;
        }

        // 3. å¤©æ´¥èŠ‚ç‚¹ï¼šå±•ç¤ºä¸­è½¬åœ°â†’å¤©æ´¥çš„äº¤é€š
        if (city === 'å¤©æ´¥') {
          const toTianjin = [...transferTrains, ...transferPlanes].filter(t => t.endCity === 'å¤©æ´¥' || t.transferTo === 'å¤©æ´¥');
          trafficHtml = toTianjin.length > 0 ? `
            <div class="mt-2 w-full bg-light rounded-ios-sm p-2 text-xs">
              <p class="font-medium text-center mb-1">æŠµè¾¾äº¤é€š</p>
              ${toTianjin.map(t => `
                <div class="flex justify-between items-center py-1 border-b border-gray-100 last:border-0">
                  <span>${t.trainNo ? `ğŸš ${t.trainNo}` : `âœˆï¸ ${t.planeNo}(${t.airline})`}</span>
                  <span>${t.startCity} | Â¥${t.price.toFixed(2)}</span>
                </div>
              `).join('')}
            </div>
          ` : '<p class="mt-2 text-xs text-gray-400">æš‚æ— æŠµè¾¾äº¤é€šæ•°æ®</p>';
        }

        // 4. æ‰€æœ‰èŠ‚ç‚¹ï¼šå±•ç¤ºå¯¹åº”åŸå¸‚çš„æ™¯ç‚¹+é¤å…ï¼ˆåˆ†æ”¯ï¼‰+ æ·»åŠ æŒ‰é’®
        const cityScenics = scenics.filter(s => s.city === city || (city === 'ä¸­è½¬åœ°' && transferCities.includes(s.city)));
        const cityRestaurants = restaurants.filter(r => r.city === city || (city === 'ä¸­è½¬åœ°' && transferCities.includes(r.city)));
        
        // æ™¯ç‚¹åˆ†æ”¯
        scenicHtml = `
          <div class="mt-3 w-full">
            <div class="flex justify-between items-center text-xs mb-1">
              <span class="font-medium flex items-center gap-1"><i class="fa-solid fa-mountain-sun text-primary"></i>æ™¯ç‚¹</span>
              <button class="text-primary hover:underline" onclick="openScenicForm('${city === 'ä¸­è½¬åœ°' ? 'ç§¦çš‡å²›' : city}')">+æ·»åŠ </button>
            </div>
            <div class="grid grid-cols-2 gap-1">
              ${cityScenics.length > 0 ? cityScenics.map(s => `
                <div class="bg-light rounded-ios-sm p-1 text-xs">${s.scenicName} Â¥${s.ticketPrice.toFixed(2)}</div>
              `).join('') : '<span class="col-span-2 text-gray-400">æš‚æ— æ™¯ç‚¹</span>'}
            </div>
          </div>
        `;

        // é¤å…åˆ†æ”¯
        restaurantHtml = `
          <div class="mt-2 w-full">
            <div class="flex justify-between items-center text-xs mb-1">
              <span class="font-medium flex items-center gap-1"><i class="fa-solid fa-utensils text-primary"></i>é¤å…</span>
              <button class="text-primary hover:underline" onclick="openRestaurantForm('${city === 'ä¸­è½¬åœ°' ? 'ç§¦çš‡å²›' : city}')">+æ·»åŠ </button>
            </div>
            <div class="grid grid-cols-2 gap-1">
              ${cityRestaurants.length > 0 ? cityRestaurants.map(r => `
                <div class="bg-light rounded-ios-sm p-1 text-xs">${r.restName} Â¥${r.perPrice.toFixed(2)}</div>
              `).join('') : '<span class="col-span-2 text-gray-400">æš‚æ— é¤å…</span>'}
            </div>
          </div>
        `;

        // èŠ‚ç‚¹æ ·å¼ï¼šæœ€åä¸€ä¸ªèŠ‚ç‚¹æ— è¿æ¥çº¿
        const lineHtml = index < routeMainCities.length - 1 ? '<div class="route-line absolute top-10 left-1/2 w-0.5"></div>' : '';

        return `
          <div class="${nodeClass} relative">
            <div class="w-8 h-8 rounded-full bg-primary text-white flex items-center justify-center route-node-active">
              ${index + 1}
            </div>
            <p class="mt-1 font-medium">${city}</p>
            ${trafficHtml}
            ${scenicHtml}
            ${restaurantHtml}
            ${lineHtml}
          </div>
        `;
      }).join('');
    }

    // ===================== æ¨¡å—æ¸²æŸ“ï¼šè‡ªå®šä¹‰åˆ†ç±» =====================
    function renderCustom() {
      const customList = document.getElementById('customList');
      const customs = Storage.get('custom');
      if (customs.length === 0) {
        customList.innerHTML = `
          <div class="col-span-1 sm:col-span-2 lg:col-span-3 flex items-center justify-center py-4 text-gray-400 text-sm">
            æš‚æ— è‡ªå®šä¹‰åˆ†ç±»ï¼Œç‚¹å‡»å³ä¸Šè§’ã€Œè‡ªå®šä¹‰ã€æ·»åŠ å§ï½
          </div>
        `;
        return;
      }
      customList.innerHTML = customs.map(custom => `
        <div class="card-ios p-4 flex items-center justify-between hover:translate-y-[-2px] transition-transform duration-200">
          <div class="flex items-center gap-3">
            <div class="w-10 h-10 rounded-full bg-primary/10 flex items-center justify-center text-primary">
              <i class="fa-solid fa-${custom.icon}"></i>
            </div>
            <div>
              <h3 class="font-medium">${custom.name}</h3>
              <p class="text-xs text-gray-500">Â¥${custom.price.toFixed(2)}</p>
              ${custom.desc ? `<p class="text-xs text-gray-400">${custom.desc}</p>` : ''}
            </div>
          </div>
          <button class="text-gray-400 hover:text-red-500" onclick="Storage.remove('custom', ${custom.id})">
            <i class="fa-solid fa-trash"></i>
          </button>
        </div>
      `).join('');
    }

    // ===================== æ¨¡å—æ¸²æŸ“ï¼šç«è½¦è½¦æ¬¡å¯¹æ¯” =====================
    function renderTrainCompare() {
      const trainCompareBody = document.getElementById('trainCompareBody');
      const trainCompareEmpty = document.getElementById('trainCompareEmpty');
      const trains = Storage.get('train');
      const compareData = [];

      // éå†ä¸­è½¬åœ°ï¼Œæ•´ç†é•¿æ˜¥â†’ä¸­è½¬åœ°ã€ä¸­è½¬åœ°â†’å¤©æ´¥çš„è½¦æ¬¡
      transferCities.forEach(city => {
        const toTransfer = trains.filter(t => t.startCity === 'é•¿æ˜¥' && t.endCity === city);
        const toTianjin = trains.filter(t => t.startCity === city && t.endCity === 'å¤©æ´¥');
        if (toTransfer.length > 0 && toTianjin.length > 0) {
          toTransfer.forEach(t1 => {
            toTianjin.forEach(t2 => {
              const duration1 = calcDuration(t1.startTime, t1.endTime);
              const duration2 = calcDuration(t2.startTime, t2.endTime);
              compareData.push({
                transfer: city,
                t1: t1,
                t1Dur: duration1,
                t2: t2,
                t2Dur: duration2,
                totalDur: `${Number(duration1.split('h')[0]) + Number(duration2.split('h')[0])}h`,
                totalPrice: t1.price + t2.price
              });
            });
          });
        }
      });

      if (compareData.length === 0) {
        trainCompareBody.innerHTML = '';
        trainCompareEmpty.classList.remove('hidden');
        return;
      }
      trainCompareEmpty.classList.add('hidden');
      trainCompareBody.innerHTML = compareData.map(item => `
        <tr class="hover:bg-light/50">
          <td class="py-3 px-2 text-sm">${item.transfer}</td>
          <td class="py-3 px-2 text-sm">${item.t1.trainNo}</td>
          <td class="py-3 px-2 text-sm">${item.t1Dur} / Â¥${item.t1.price.toFixed(2)}</td>
          <td class="py-3 px-2 text-sm">${item.t2.trainNo}</td>
          <td class="py-3 px-2 text-sm">${item.t2Dur} / Â¥${item.t2.price.toFixed(2)}</td>
          <td class="py-3 px-2 text-sm font-medium text-primary">${item.totalDur} / Â¥${item.totalPrice.toFixed(2)}</td>
        </tr>
      `).join('');
    }

    // ===================== æ¨¡å—æ¸²æŸ“ï¼šé£æœºèˆªç­å¯¹æ¯” =====================
    function renderPlaneCompare() {
      const planeCompareBody = document.getElementById('planeCompareBody');
      const planeCompareEmpty = document.getElementById('planeCompareEmpty');
      const planes = Storage.get('plane');
      const compareData = [];

      // éå†ä¸­è½¬åœ°ï¼Œæ•´ç†é•¿æ˜¥â†’ä¸­è½¬åœ°ã€ä¸­è½¬åœ°â†’å¤©æ´¥çš„èˆªç­
      transferCities.forEach(city => {
        const toTransfer = planes.filter(p => p.startCity.includes('é•¿æ˜¥') && p.endCity.includes(city));
        const toTianjin = planes.filter(p => p.startCity.includes(city) && p.endCity.includes('å¤©æ´¥'));
        if (toTransfer.length > 0 && toTianjin.length > 0) {
          toTransfer.forEach(p1 => {
            toTianjin.forEach(p2 => {
              const duration1 = calcDuration(p1.startTime, p1.endTime);
              const duration2 = calcDuration(p2.startTime, p2.endTime);
              compareData.push({
                transfer: city,
                p1: p1,
                p1Dur: duration1,
                p2: p2,
                p2Dur: duration2,
                totalDur: `${Number(duration1.split('h')[0]) + Number(duration2.split('h')[0])}h`,
                totalPrice: p1.price + p2.price
              });
            });
          });
        }
      });

      if (compareData.length === 0) {
        planeCompareBody.innerHTML = '';
        planeCompareEmpty.classList.remove('hidden');
        return;
      }
      planeCompareEmpty.classList.add('hidden');
      planeCompareBody.innerHTML = compareData.map(item => `
        <tr class="hover:bg-light/50">
          <td class="py-3 px-2 text-sm">${item.transfer}</td>
          <td class="py-3 px-2 text-sm">${item.p1.planeNo}(${item.p1.airline})</td>
          <td class="py-3 px-2 text-sm">${item.p1Dur} / Â¥${item.p1.price.toFixed(2)}</td>
          <td class="py-3 px-2 text-sm">${item.p2.planeNo}(${item.p2.airline})</td>
          <td class="py-3 px-2 text-sm">${item.p2Dur} / Â¥${item.p2.price.toFixed(2)}</td>
          <td class="py-3 px-2 text-sm font-medium text-primary">${item.totalDur} / Â¥${item.totalPrice.toFixed(2)}</td>
        </tr>
      `).join('');
    }

    // ===================== å·¥å…·å‡½æ•°ï¼šæ—¶é—´/æ—¥æœŸæ ¼å¼åŒ– =====================
    // æ ¼å¼åŒ–datetime-localä¸º å¹´-æœˆ-æ—¥ æ—¶:åˆ†
    function formatTime(timeStr) {
      if (!timeStr) return 'æœªå¡«å†™';
      const date = new Date(timeStr);
      return `${date.getFullYear()}-${(date.getMonth()+1).toString().padStart(2,0)}-${date.getDate().toString().padStart(2,0)} ${date.getHours().toString().padStart(2,0)}:${date.getMinutes().toString().padStart(2,0)}`;
    }

    // æ ¼å¼åŒ–dateä¸º å¹´-æœˆ-æ—¥
    function formatDate(dateStr) {
      if (!dateStr) return 'æœªå¡«å†™';
      const date = new Date(dateStr);
      return `${date.getFullYear()}-${(date.getMonth()+1).toString().padStart(2,0)}-${date.getDate().toString().padStart(2,0)}`;
    }

    // è®¡ç®—ä¸¤ä¸ªæ—¥æœŸä¹‹é—´çš„å¤©æ•°
    function calcDays(startDate, endDate) {
      if (!startDate || !endDate) return 0;
      const start = new Date(startDate);
      const end = new Date(endDate);
      const diff = end - start;
      return Math.ceil(diff / (1000 * 60 * 60 * 24));
    }

    // è®¡ç®—äº¤é€šè€—æ—¶ï¼ˆæ—¶ï¼‰
    function calcDuration(startTime, endTime) {
      if (!startTime || !endTime) return '0h';
      const start = new Date(startTime);
      const end = new Date(endTime);
      const diff = end - start;
      const hours = (diff / (1000 * 60 * 60)).toFixed(0);
      return `${hours}h`;
    }

    // ===================== å·¥å…·å‡½æ•°ï¼šå¼¹çª—/è¡¨å•å¿«æ·æ“ä½œ =====================
    // æ‰“å¼€å¯¹æ¯”å¼¹çª—
    function openCompareModal() {
      document.getElementById('compareModal').classList.remove('hidden');
      renderTrainCompare(); // é»˜è®¤æ˜¾ç¤ºç«è½¦å¯¹æ¯”
    }

    // è·¯çº¿èŠ‚ç‚¹å¿«æ·æ·»åŠ æ™¯ç‚¹ï¼ˆè‡ªåŠ¨å¡«å……åŸå¸‚ï¼‰
    function openScenicForm(city) {
      // åˆ‡æ¢åˆ°æ™¯ç‚¹æ ‡ç­¾
      document.querySelectorAll('.tab-link').forEach(l => l.classList.remove('tab-active'));
      document.querySelectorAll('.tab-content').forEach(c => c.classList.add('hidden'));
      document.querySelector('.tab-link[href="#scenic"]').classList.add('tab-active');
      document.getElementById('scenic').classList.remove('hidden');
      // æ˜¾ç¤ºè¡¨å•å¹¶å¡«å……åŸå¸‚
      const scenicForm = document.getElementById('scenicForm');
      scenicForm.classList.remove('hidden');
      scenicForm.querySelector('input[name="city"]').value = city;
      scenicForm.scrollIntoView({ behavior: 'smooth' });
    }

    // è·¯çº¿èŠ‚ç‚¹å¿«æ·æ·»åŠ é¤å…ï¼ˆè‡ªåŠ¨å¡«å……åŸå¸‚ï¼‰
    function openRestaurantForm(city) {
      // åˆ‡æ¢åˆ°é¤å…æ ‡ç­¾
      document.querySelectorAll('.tab-link').forEach(l => l.classList.remove('tab-active'));
      document.querySelectorAll('.tab-content').forEach(c => c.classList.add('hidden'));
      document.querySelector('.tab-link[href="#restaurant"]').classList.add('tab-active');
      document.getElementById('restaurant').classList.remove('hidden');
      // æ˜¾ç¤ºè¡¨å•å¹¶å¡«å……åŸå¸‚
      const restForm = document.getElementById('restaurantForm');
      restForm.classList.remove('hidden');
      restForm.querySelector('input[name="city"]').value = city;
      restForm.scrollIntoView({ behavior: 'smooth' });
    }
  </script>
</body>
</html>
